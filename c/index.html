<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">   
    <link rel="shortcut icon" href="../img/favicon.ico">

    <title>C API - libsoc</title>

    <link href="../css/bootstrap-custom.min.css" rel="stylesheet">
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css" rel="stylesheet">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/font-hack/2.018/css/hack.min.css">
    <link href='//fonts.googleapis.com/css?family=PT+Sans:400,400italic,700,700italic&subset=latin-ext,latin' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,700italic,400,300,600,700&subset=latin-ext,latin' rel='stylesheet' type='text/css'>
    <link href="../css/base.css" rel="stylesheet">
    <link href="../css/cinder.css" rel="stylesheet">
    <link rel="stylesheet" href="../css/highlight.css">

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

    <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.5.18/webfont.js"></script>
    <script>
    WebFont.load({
        google: {
            families: ['Open Sans', 'PT Sans']
        }
    });
    </script>

    
</head>

<body>

    <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            

            <!-- Main title -->
            <a class="navbar-brand" href="..">libsoc</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                
                
                    <li >
                        <a href="..">Introduction</a>
                    </li>
                
                
                
                    <li class="active">
                        <a href="./">C API</a>
                    </li>
                
                
                
                    <li >
                        <a href="../python/">Python Bindings</a>
                    </li>
                
                
                </ul>
            

            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                
                    <li >
                        <a rel="next" href="..">
                            <i class="fa fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li >
                        <a rel="prev" href="../python/">
                            Next <i class="fa fa-arrow-right"></i>
                        </a>
                    </li>
                
                
                    <li>
                        <a href="http://github.com/jackmitch/libsoc">
                            
                                <i class="fa fa-github"></i>
                            
                            GitHub
                        </a>
                    </li>
                
            </ul>
        </div>
    </div>
</div>

    <div class="container">
        
        <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="first-level active"><a href="#gpio">GPIO</a></li>
        
            <li class="second-level"><a href="#data-types">Data Types</a></li>
            
                <li class="third-level"><a href="#gpio_mode">gpio_mode</a></li>
            
                <li class="third-level"><a href="#gpio_direction">gpio_direction</a></li>
            
                <li class="third-level"><a href="#gpio_level">gpio_level</a></li>
            
                <li class="third-level"><a href="#gpio_edge">gpio_edge</a></li>
            
                <li class="third-level"><a href="#gpio_int_ret">gpio_int_ret</a></li>
            
        
            <li class="second-level"><a href="#functions">Functions</a></li>
            
                <li class="third-level"><a href="#libsoc_gpio_request">libsoc_gpio_request</a></li>
            
                <li class="third-level"><a href="#libsoc_gpio_free">libsoc_gpio_free</a></li>
            
                <li class="third-level"><a href="#libsoc_gpio_set_direction">libsoc_gpio_set_direction</a></li>
            
                <li class="third-level"><a href="#libsoc_gpio_get_direction">libsoc_gpio_get_direction</a></li>
            
                <li class="third-level"><a href="#libsoc_gpio_set_level">libsoc_gpio_set_level</a></li>
            
                <li class="third-level"><a href="#libsoc_gpio_get_level">libsoc_gpio_get_level</a></li>
            
                <li class="third-level"><a href="#libsoc_gpio_set_edge">libsoc_gpio_set_edge</a></li>
            
                <li class="third-level"><a href="#libsoc_gpio_get_edge">libsoc_gpio_get_edge</a></li>
            
                <li class="third-level"><a href="#libsoc_gpio_wait_interrupt">libsoc_gpio_wait_interrupt</a></li>
            
                <li class="third-level"><a href="#libsoc_gpio_callback_interrupt">libsoc_gpio_callback_interrupt</a></li>
            
                <li class="third-level"><a href="#libsoc_gpio_callback_interrupt_cancel">libsoc_gpio_callback_interrupt_cancel</a></li>
            
        
    
        <li class="first-level "><a href="#spi">SPI</a></li>
        
    
        <li class="first-level "><a href="#i2c">I2C</a></li>
        
    
        <li class="first-level "><a href="#pwm">PWM</a></li>
        
    
    </ul>
</div></div>
        <div class="col-md-9" role="main">

<h1 id="gpio">GPIO</h1>
<hr />
<h2 id="data-types">Data Types</h2>
<hr />
<h3 id="gpio_mode">gpio_mode</h3>
<p>Determines the way in which libsoc handles exporting and unexporting
GPIOs in the Linux subsystem.</p>
<ul>
<li>
<p><strong>LS_SHARED</strong></p>
<p>if the gpio is already exported then it will not unexport
the GPIO on free. If it is not exported, then it will
unexport on free.</p>
</li>
<li>
<p><strong>LS_GREEDY</strong></p>
<p>will succeed if the GPIO is already exported, but will 
always unexport the GPIO on free.</p>
</li>
<li>
<p><strong>LS_WEAK</strong></p>
<p>will fail if GPIO is already exported, will always unexport
on free.</p>
</li>
</ul>
<hr />
<h3 id="gpio_direction">gpio_direction</h3>
<p>Used for setting and reading the direction of the GPIO pin.</p>
<ul>
<li>
<p><strong>DIRECTION_ERROR</strong></p>
<p>Returned when the GPIO direction could not be read</p>
</li>
<li>
<p><strong>INPUT</strong></p>
<p>GPIO input mode, it's input value can be read</p>
</li>
<li>
<p><strong>OUTPUT</strong></p>
<p>GPIO output mode, it's output value can be written</p>
</li>
</ul>
<hr />
<h3 id="gpio_level">gpio_level</h3>
<p>Used for setting and reading the level of the GPIO pin.</p>
<ul>
<li>
<p><strong>LEVEL_ERROR</strong></p>
<p>Returned when the GPIO level could not be read</p>
</li>
<li>
<p><strong>LOW</strong></p>
<p>GPIO value low, usually logic 0 on the pin, but could be 1 if
the gpio is inverted.</p>
</li>
<li>
<p><strong>HIGH</strong></p>
<p>GPIO value high, usually logic 1 on the pin, but could be 0 if
the gpio is inverted.</p>
</li>
</ul>
<hr />
<h3 id="gpio_edge">gpio_edge</h3>
<p>Used for setting and reading the edge of the GPIO pin.</p>
<ul>
<li>
<p><strong>EDGE_ERROR</strong></p>
<p>Returned when the GPIO edge could not be read</p>
</li>
<li>
<p><strong>RISING</strong></p>
<p>GPIO interrupt is triggered on a rising edge, e.g. logic level
0 followed by 1</p>
</li>
<li>
<p><strong>FALLING</strong></p>
<p>GPIO interrupt is triggered on a falling edge, e.g. logic level
1 followed by 0</p>
</li>
<li>
<p><strong>NONE</strong></p>
<p>GPIO interrupt edge is not set</p>
</li>
<li>
<p><strong>BOTH</strong></p>
<p>GPIO interrupt is triggered on both a falling and rising edge</p>
</li>
</ul>
<hr />
<h3 id="gpio_int_ret">gpio_int_ret</h3>
<p>Return type for blocked GPIO interrupts.</p>
<ul>
<li>
<p><strong>LS_INT_ERROR</strong></p>
<p>Error condition</p>
</li>
<li>
<p><strong>LS_INT_TRIGGERED</strong></p>
<p>Interrupt was triggered</p>
</li>
<li>
<p><strong>LS_INT_TIMEOUT</strong></p>
<p>GPIO poll timedout</p>
</li>
</ul>
<h2 id="functions">Functions</h2>
<hr />
<h3 id="libsoc_gpio_request">libsoc_gpio_request</h3>
<pre><code class="C">gpio * libsoc_gpio_request(unsigned int gpio_id, gpio_mode mode)
</code></pre>

<ul>
<li>
<p><em>unsigned int</em> <strong>gpio_id</strong></p>
<p>the Linux ID number for the GPIO you wish to use</p>
</li>
<li>
<p><em><a href="#gpio_mode">gpio_mode</a></em> <strong>mode</strong></p>
<p>the mode in which libsoc handles the GPIO file descriptor</p>
</li>
</ul>
<p>Request a GPIO by it's Linux ID number and set the <a href="#gpio_mode">gpio_mode</a>
under which libsoc will hold the file descriptor. Returns a malloced gpio struct
which will need to be freed by <a href="#libsoc_gpio_free">libsoc_gpio_free</a> when no
longer needed.</p>
<p>Returns <code>NULL</code> on failure.</p>
<hr />
<h3 id="libsoc_gpio_free">libsoc_gpio_free</h3>
<pre><code class="c">int libsoc_gpio_free(gpio * gpio)
</code></pre>

<ul>
<li>
<p><em>gpioi*</em> <strong>gpio</strong></p>
<p>the previously requested gpio that you wish to release</p>
</li>
</ul>
<p>Free the memory associated with a previously requested GPIO and close the file
descriptors.</p>
<p>Returns <code>EXIT_SUCCESS</code>/<code>EXIT_FAILURE</code></p>
<hr />
<h3 id="libsoc_gpio_set_direction">libsoc_gpio_set_direction</h3>
<pre><code class="c">int libsoc_gpio_set_direction(gpio * current_gpio, gpio_direction direction)
</code></pre>

<ul>
<li>
<p><em>gpio*</em> <strong>current_gpio</strong></p>
<p>requested gpio that you wish to set the direction of</p>
</li>
<li>
<p><em><a href="#gpio_direction">gpio_direction</a></em> <strong>direction</strong></p>
<p>direction you wish to set the gpio to</p>
</li>
</ul>
<p>Set the direction of a GPIO, <code>INPUT</code> for reading a GPIO, <code>OUTPUT</code> for setting a
GPIO.</p>
<p>Returns <code>EXIT_SUCCESS</code>/<code>EXIT_FAILURE</code></p>
<hr />
<h3 id="libsoc_gpio_get_direction">libsoc_gpio_get_direction</h3>
<pre><code class="c">gpio_direction libsoc_gpio_get_direction(gpio * current_gpio)
</code></pre>

<ul>
<li>
<p><em>gpio*</em> <strong>current_gpio</strong></p>
<p>requested gpio that you wish to get the direction of</p>
</li>
</ul>
<p>Get the current <a href="#gpio_direction">gpio_direction</a> of a requested GPIO.</p>
<p>Returns <a href="#gpio_direction">gpio_direction</a>, <code>DIRECTION_ERROR</code> on failure,
<code>INPUT</code>/<code>OUTPUT</code> on success.</p>
<hr />
<h3 id="libsoc_gpio_set_level">libsoc_gpio_set_level</h3>
<pre><code class="c">int libsoc_gpio_set_level(gpio * current_gpio, gpio_level level)
</code></pre>

<ul>
<li>
<p><em>gpio *</em> <strong>current_gpio</strong></p>
<p>requested gpio you wish to set the level of</p>
</li>
<li>
<p><em><a href="#gpio_level">gpio_level</a></em> <strong>level</strong></p>
<p>level you wish to set the gpio to</p>
</li>
</ul>
<p>Set the output level of a requested GPIO to <code>HIGH</code> or <code>LOW</code>.</p>
<p>Returns <code>EXIT_SUCCESS</code>/<code>EXIT_FAILURE</code></p>
<hr />
<h3 id="libsoc_gpio_get_level">libsoc_gpio_get_level</h3>
<pre><code class="c">gpio_level libsoc_gpio_get_level(gpio * current_gpio)
</code></pre>

<ul>
<li>
<p><em>gpio *</em> <strong>current_gpio</strong></p>
<p>requested gpio you wish to get the level of</p>
</li>
</ul>
<p>Get the current <a href="#gpio_level">gpio_level</a> of a requested GPIO.</p>
<p>Returns <a href="#gpio_level">gpio_level</a>, <code>LEVEL_ERROR</code> on failure,
<code>LOW</code>/<code>HIGH</code> on success.</p>
<hr />
<h3 id="libsoc_gpio_set_edge">libsoc_gpio_set_edge</h3>
<pre><code class="c">int libsoc_gpio_set_edge(gpio * current_gpio, gpio_edge edge)
</code></pre>

<ul>
<li>
<p><em>gpio *</em> <strong>current_gpio</strong></p>
<p>requested gpio you wish to set the edge of</p>
</li>
<li>
<p><em><a href="#gpio_edge">gpio_edge</a></em> <strong>edge</strong></p>
<p>edge you wish to set the gpio to</p>
</li>
</ul>
<p>Set the edge type of a requested GPIO. The edge is the type of signal
change that will trigger interrupt detection. See <a href="#gpio_edge">gpio_edge</a>
for explanations of the different types of edges and how they work.</p>
<p>Returns <code>EXIT_SUCCESS</code>/<code>EXIT_FAILURE</code></p>
<hr />
<h3 id="libsoc_gpio_get_edge">libsoc_gpio_get_edge</h3>
<pre><code class="c">gpio_edge libsoc_gpio_get_edge(gpio * current_gpio)
</code></pre>

<ul>
<li>
<p><em>gpio *</em> <strong>current_gpio</strong></p>
<p>requested gpio you wish to get the edge of</p>
</li>
</ul>
<p>Get the current <a href="#gpio_edge">gpio_edge</a> of a requested GPIO.</p>
<p>Returns <a href="#gpio_edge">gpio_edge</a>, <code>EDGE_ERROR</code> on failure,
<code>RISING</code>/<code>FALLING</code>/<code>BOTH</code>/<code>NONE</code> on success.</p>
<hr />
<h3 id="libsoc_gpio_wait_interrupt">libsoc_gpio_wait_interrupt</h3>
<pre><code class="c">int libsoc_gpio_wait_interrupt(gpio * gpio, int timeout)
</code></pre>

<ul>
<li>
<p><em>gpio *</em> <strong>gpio</strong></p>
<p>requested gpio you wish to wait for an interrupt on</p>
</li>
<li>
<p><em>int</em> <strong>timeout</strong></p>
<p>the number of seconds to wait for the interrupt, -1 for block indefinitly</p>
</li>
</ul>
<p>Block for a set amount of seconds (or indefinitly) waiting for an interrupt on a
GPIO to occur. If you wish to use a non-blocking interrupt mechanism see
<a href="#libsoc_gpio_callback_interrupt">libsoc_gpio_callback_interrupt</a>.</p>
<p>Returns <code>LS_INT_ERROR</code> on failure, <code>LS_INT_TRIGGERED</code> on captured interrupt,
<code>LS_INT_TIMEOUT</code> if no interrupt was captured in the specified time.</p>
<hr />
<h3 id="libsoc_gpio_callback_interrupt">libsoc_gpio_callback_interrupt</h3>
<pre><code class="c">int libsoc_gpio_callback_interrupt(gpio * gpio, int (*callback_fn) (void *), void *arg)
</code></pre>

<ul>
<li>
<p><em>gpio *</em> <strong>gpio</strong></p>
<p>requested gpio you wish to set an interrupt handler for</p>
</li>
<li>
<p><em>int (*callback_fn) (void *)</em> <strong>function</strong></p>
<p>name of the function to use as the interrupt handler. Must match the prototype
<code>int* function(void* ptr)</code></p>
</li>
<li>
<p><em>void *</em> <strong>arg</strong></p>
<p>void casted pointer you wish to be passed to your interrupt handler</p>
</li>
</ul>
<p>Setup an interrupt handler on a GPIO. This will start a new pthread with an infinite poll
on the GPIO waiting for the interrupt. When an interrupt is detected the supplied function
will run in the thread, and then return to waiting for an interrupt.</p>
<p>Only one interrupt will be queued if it arrives while your supplied function is being run,
so it is possible to miss interrupts if they happen too fast.</p>
<p>Returns <code>EXIT_SUCCESS</code>/<code>EXIT_FAILURE</code></p>
<hr />
<h3 id="libsoc_gpio_callback_interrupt_cancel">libsoc_gpio_callback_interrupt_cancel</h3>
<pre><code class="c">int libsoc_gpio_callback_interrupt_cancel(gpio * gpio)
</code></pre>

<ul>
<li>
<p><em>gpio *</em> <strong>gpio</strong></p>
<p>the gpio on which to cancel a waiting interrupt handler</p>
</li>
</ul>
<p>Cancel a previously set interrupt handler on a GPIO. This uses the pthread_cancel function,
so it may cancel mid way through your interrupt handler function.</p>
<p>Returns <code>EXIT_SUCCESS</code>/<code>EXIT_FAILURE</code></p>
<hr />
<h1 id="spi">SPI</h1>
<h1 id="i2c">I2C</h1>
<h1 id="pwm">PWM</h1></div>
        
    </div>

    <footer class="col-md-12 text-center">
        <hr>
        <p>
        <small>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p></small>
    </footer>

    <script src="../js/jquery-1.10.2.min.js"></script>
    <script src="../js/bootstrap-3.0.3.min.js"></script>
    <script src="../js/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script>
    var base_url = '..';
    </script>
    <script data-main="../mkdocs/js/search.js" src="../mkdocs/js/require.js"></script>
    <script src="../js/base.js"></script>

    <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">
                        <span aria-hidden="true">&times;</span>
                        <span class="sr-only">Close</span>
                    </button>
                    <h4 class="modal-title" id="exampleModalLabel">Search</h4>
                </div>
                <div class="modal-body">
                    <p>
                        From here you can search these documents. Enter your search terms below.
                    </p>
                    <form role="form">
                        <div class="form-group">
                            <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                        </div>
                    </form>
                    <div id="mkdocs-search-results"></div>
                </div>
                <div class="modal-footer">
                </div>
            </div>
        </div>
    </div>

    </body>

</html>
